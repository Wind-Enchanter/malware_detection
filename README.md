# malware_detection

æ¯•è®¾éšè®°ï¼Œé˜²æ­¢é—å¿˜ ğŸ±â€ğŸ‘“

### ä»»åŠ¡

~~æŠ€æœ¯è·¯çº¿é€‰æ‹©&æ¶æ„è®¾è®¡~~

~~æ„å»ºæ•°æ®é›†ï¼ˆ2022.3.19å®Œæˆï¼‰~~

~~è®­ç»ƒæ¨¡å‹ï¼ˆ2022.4.10å®Œæˆï¼‰~~

~~æ¨¡å—æ•´åˆ&ç•Œé¢~~

ç³»ç»Ÿéƒ¨ç½²åˆ°Ubuntuï¼ˆ04.23ï¼šå‘ç°Ubuntuæ˜¯32ä½çš„ï¼Œæ²¡æ³•å®‰Tensorflowï¼Œåªèƒ½é‡æ–°æ­å»ºç¯å¢ƒï¼Œå·¥æœŸ++ï¼‰

ç³»ç»Ÿæµ‹è¯•

å†™è®ºæ–‡





### æ–‡ä»¶ç»„æˆ

- **/cuckoo_report_analyzer ï¼ˆç”ŸæˆAPIè°ƒç”¨æ•°æ®é›†ï¼‰**

â€‹	**/report** é›†ä¸­ä¿å­˜cuckooäº§ç”Ÿçš„æŠ¥å‘Šï¼Œæ ¼å¼[num]_report.json

â€‹	**/storage** é›†ä¸­ä¿å­˜split_reports.pyå¤„ç†çš„ç»“æœprocess.jsonï¼Œæ¯ä¸ªæ–‡ä»¶ä¿å­˜åœ¨ä»¥[exe_name]å‘½åçš„å­æ–‡ä»¶å¤¹ä¸‹

â€‹	**move_report.py** æ”¶é›†ï¼ˆæ‰¹é‡ç§»åŠ¨åˆ°/reportï¼‰cuckoo SandBoxè¿è¡Œæ ·æœ¬äº§ç”Ÿçš„æŠ¥å‘Šreport.json

â€‹	**main.py** å¤„ç†å•ä¸ªreport.jsonï¼Œä»ä¸­åˆ†å‡ºprocess.jsonåˆ°./storage/[exe_name]/æ–‡ä»¶å¤¹

â€‹	**split_reports.py** æ‰¹é‡å¤„ç†report.jsonï¼Œä»ä¸­åˆ†å‡ºprocess.jsonåˆ°./storage/[exe_name]/æ–‡ä»¶å¤¹





- **/api_reader ï¼ˆç”ŸæˆAPIè°ƒç”¨æ•°æ®é›†ï¼‰**

â€‹	**api.csv** ä¿å­˜apiå‡½æ•°ä¸æ•°å­—çš„å¯¹åº”å…³ç³»ï¼Œç”¨ä»¥ç´¢å¼•

â€‹	**LIST.TXT** å­˜æ”¾æ ·æœ¬çš„åç§°ï¼Œç”¨æ¥ç”Ÿæˆprocess.jsonæ–‡ä»¶è·¯å¾„

â€‹		æœ¬æ–‡ä»¶äº§ç”Ÿæ–¹å¼ï¼š

```shell
# åœ¨/cuckoo_report_analyzer/storage/ç›®å½•ä¸‹
DIR *.*  /B >LIST.TXT
# ç„¶åæ‰‹åŠ¨åˆ é™¤LIST.TXTä¸­çš„â€œLIST.TXTâ€å’Œâ€œtest.batâ€
# å¤åˆ¶LIST.TXTåˆ°/api_reader
```

â€‹	**main.py** å°†LIST.TXTåˆ—ä¸¾çš„æ–‡ä»¶å¤¹ä¸­çš„jsonæ–‡ä»¶æå–ä¸ºç´¢å¼•å¥½çš„apiæ•°å­—åºåˆ—ï¼Œä¿å­˜åˆ°test_test.csvä¸­

â€‹	**main_1.py** ä»¥xx.exeä¸ºå‚æ•°ï¼Œå¯ä»¥è¾“å‡ºç´¢å¼•å¥½çš„apiæ•°å­—åºåˆ—ï¼Œå¹¶ä¿å­˜åˆ°csvæ–‡ä»¶





- **/classification_apiï¼ˆè®­ç»ƒæ¨¡å‹Aæ—¶ä½¿ç”¨ï¼‰**

â€‹	**/archive/dynamic_api_call_sequence_per_malware_100_0_306.csv**

â€‹	æ•°æ®é›†ï¼Œæ ¼å¼ï¼šhash, api_num[0:99], if_malware

â€‹	**behavioral-malware-detection-with-cnn-lstm.ipynb**

â€‹	jupyter notebookè¿è¡Œï¼Œæ³¨æ„ä¿®æ”¹æ•°æ®é›†è·¯å¾„

**behavioral-malware-detection-based-on-api-calls_model.h5**

ä¿å­˜è®­ç»ƒå¥½çš„æ¨¡å‹



- **/classification_trafficï¼ˆè®­ç»ƒæ¨¡å‹Bæ—¶ä½¿ç”¨ï¼‰**

â€‹	ä½¿ç”¨ç‹ä¼Ÿåˆ›å»ºçš„æ•°æ®é›†åŠé…å¥—å·¥å…·ï¼Œç”Ÿæˆå¯¹åº”å›¾ç‰‡æ•°æ®

â€‹	https://github.com/echowei/DeepTraffic

â€‹	ä¿®æ”¹train.ipynbæ–‡ä»¶ä¸­æ•°æ®è·¯å¾„



- **predict_api.pyï¼ˆä½¿ç”¨æ¨¡å‹Aè¿›è¡Œé¢„æµ‹ï¼‰**

è¾“å…¥ï¼šprocesses.jsonæ–‡ä»¶è·¯å¾„

è¾“å‡ºï¼šé¢„æµ‹çš„ç»“æœ



- **predict_traffic.pyï¼ˆä½¿ç”¨æ¨¡å‹Bè¿›è¡Œé¢„æµ‹ï¼‰**

è¾“å…¥ï¼šæµé‡å›¾ç‰‡è·¯å¾„

è¾“å‡ºï¼šé¢„æµ‹çš„ç»“æœ



- **main.py**

ç³»ç»Ÿç•Œé¢ï¼Œåœ¨windowsæµ‹è¯•å¯è¡Œ



- **main_ubuntu.py**

é€‚åˆUbuntuçš„ç³»ç»Ÿç•Œé¢ï¼Œå’Œmain.pyçš„åŒºåˆ«æ˜¯æ–‡ä»¶è·¯å¾„ä¸åŒ
